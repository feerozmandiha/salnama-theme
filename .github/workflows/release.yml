name: Release Theme
on:
  push:
    tags:
      - 'v*'

jobs:
  build-and-release:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.0'
          
      - name: Validate theme
        run: |
          if [ ! -f style.css ]; then
            echo "âŒ ÙØ§ÛŒÙ„ style.css ÛŒØ§ÙØª Ù†Ø´Ø¯"
            exit 1
          fi
          if [ ! -f functions.php ]; then
            echo "âŒ ÙØ§ÛŒÙ„ functions.php ÛŒØ§ÙØª Ù†Ø´Ø¯"
            exit 1
          fi
          echo "âœ… Ø³Ø§Ø®ØªØ§Ø± Ù‚Ø§Ù„Ø¨ Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª"
          
      - name: Create ZIP package
        run: |
          # Ø§ÛŒØ¬Ø§Ø¯ Ù¾ÙˆØ´Ù‡ Ø¨Ø§ Ù†Ø§Ù… ØµØ­ÛŒØ­
          mkdir salnama-theme
          # Ú©Ù¾ÛŒ ØªÙ…Ø§Ù… ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø¨Ù‡ Ù¾ÙˆØ´Ù‡
          cp -r *.php templates/ assets/ languages/ salnama-theme/
          # Ø§ÛŒØ¬Ø§Ø¯ ÙØ§ÛŒÙ„ ZIP
          zip -r salnama-theme.zip salnama-theme/
          # Ù†Ù…Ø§ÛŒØ´ Ø³Ø§Ø®ØªØ§Ø±
          echo "ğŸ“¦ Ø³Ø§Ø®ØªØ§Ø± Ù¾Ú©ÛŒØ¬:"
          unzip -l salnama-theme.zip
          
      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          files: salnama-theme.zip
          token: ${{ secrets.GITHUB_TOKEN }}